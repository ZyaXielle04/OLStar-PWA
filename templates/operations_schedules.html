<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="csrf-token" content="{{ csrf_token() }}">

  <title>OLStar | Bookings - Schedules</title>

  <!-- External CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/schedules.css') }}">
</head>
<body>

  <div class="layout">

      <!-- Sidebar -->
      <aside class="sidebar">
        <div class="sidebar-header">
          <h2>Admin Panel</h2>
        </div>

        <nav class="nav">
          <a href="{{ url_for('pages.admin_dashboard') }}" class="nav-link">Dashboard</a>
          <a href="{{ url_for('pages.admin_users') }}" class="nav-link">Users</a>
          <a href="{{ url_for('pages.admin_transport_units') }}" class="nav-link">Transport Units</a>

          <!-- Operations (exposed) -->
          <a href="{{ url_for('pages.bookings_schedules') }}" class="nav-link active">Schedules</a>
          <a href="{{ url_for('pages.bookings_track_drivers') }}" class="nav-link">Track Drivers</a>
          <a href="{{ url_for('pages.bookings_transactions') }}" class="nav-link">Transaction History</a>

          <a href="{{ url_for('pages.admin_settings') }}" class="nav-link">Settings</a>
        </nav>

        <div class="sidebar-footer">
          <a href="{{ url_for('pages.admin_logout') }}" class="logout-btn">Logout</a>
        </div>
      </aside>

    <!-- Main Content -->
    <main class="content">

      <header class="page-header">
        <button id="btnToggleSidebar" class="hamburger">☰</button>
        <h1>Schedules</h1>
        <p class="subtitle">View and manage all booking schedules</p>

        <!-- Action Buttons -->
        <div class="actions">
          <label for="importDate">Import schedules for date:</label>
          <input type="date" id="dateFilter" class="date-filter" />

          <select id="driverFilter">
              <option value="">— All Drivers —</option>
          </select>

          <label for="fileInput" class="btn">Upload XLS/XLSX</label>
          <button class="btn" id="addManualBtn">Add Schedule Manually</button>
        </div>
      </header>

      

      <input type="file" id="fileInput" accept=".xlsx,.xls" style="display:none;" />

      <!-- Bookings Cards Container -->
      <section class="cards" id="bookingsContainer">
        <p id="loadingText" style="text-align:center; color:#6b7280; font-style:italic;">
          Loading bookings...
        </p>
      </section>

      <div id="manualModal" class="modal">
        <div class="modal-content">

          <div class="modal-header">
            <h2>Add New Schedule</h2>
            <span id="closeModal" class="close">&times;</span>
          </div>

          <form id="manualForm">

            <!-- Trip Details -->
            <div class="form-section">
              <h3>Trip Details</h3>
              <div class="form-grid">

                <div class="form-field">
                  <label>Client Name *</label>
                  <input name="clientName" required />
                </div>

                <div class="form-field">
                  <label>Contact Number</label>
                  <input name="contactNumber" />
                </div>

                <div class="form-field">
                  <label>Pickup Location *</label>
                  <input name="pickup" required />
                </div>

                <div class="form-field">
                  <label>Dropoff Location *</label>
                  <input name="dropOff" required />
                </div>

                <div class="form-field">
                  <label>Date *</label>
                  <input type="date" name="date" required />
                </div>

                <div class="form-field">
                  <label>Time *</label>
                  <input type="text" name="time" placeholder="e.g. 11:35AM" required />
                </div>

                <div class="form-field">
                  <label>PAX</label>
                  <input name="pax" />
                </div>

                <div class="form-field">
                  <label>Flight Number</label>
                  <input name="flightNumber" />
                </div>

                <div class="form-field">
                  <label>Luggage</label>
                  <input name="luggage" />
                </div>

                <div class="form-field">
                    <label for="tripType">Trip Type</label>
                    <select name="tripType" id="tripType" class="styled-select">
                        <option value="Arrival">Arrival</option>
                        <option value="Departure">Departure</option>
                        <option value="Special">Special</option>
                    </select>
                </div>

              </div>
            </div>

            <!-- Financial & Company -->
            <div class="form-section">
              <h3>Financial & Company</h3>
              <div class="form-grid">

                <div class="form-field">
                  <label>Amount</label>
                  <input name="amount" />
                </div>

                <div class="form-field">
                  <label>Driver Rate</label>
                  <input name="driverRate" />
                </div>

                <div class="form-field">
                  <label>Company</label>
                  <input name="company" />
                </div>

                <div class="form-field">
                  <label>Booking Type</label>
                  <input name="bookingType" />
                </div>

              </div>
            </div>

            <!-- Driver & Vehicle -->
            <div class="form-section">
              <h3>Driver & Vehicle</h3>
              <div class="form-grid">

                <div class="form-field">
                  <label>Driver Name</label>
                  <input name="driverName" id="driverName" list="driverSuggestions" autocomplete="off" />
                  <datalist id="driverSuggestions"></datalist>
                </div>

                <div class="form-field">
                  <label>Driver Phone</label>
                  <input name="cellPhone" id="cellPhone" />
                </div>

                <div class="form-field">
                    <label for="plateNumber">Plate Number</label>
                    <input id="plateNumber" name="plateNumber" list="plateSuggestions" placeholder="Select or type plate number" required />
                    <datalist id="plateSuggestions"></datalist>
                </div>

                <div class="form-field">
                    <label for="transportUnit">Transport Unit</label>
                    <input id="transportUnit" name="transportUnit" placeholder="Auto-filled from plate number" required />
                </div>

                <div class="form-field">
                    <label for="unitType">Unit Type</label>
                    <input id="unitType" name="unitType" placeholder="Auto-filled from plate number" required />
                </div>

                <div class="form-field">
                    <label for="color">Vehicle Color</label>
                    <input id="color" name="color" placeholder="Auto-filled from plate number" required />
                </div>

              </div>
            </div>

            <!-- Notes -->
            <div class="form-section">
              <h3>Notes</h3>
              <div class="form-field">
                <label>Additional Notes</label>
                <textarea name="note"></textarea>
              </div>
            </div>

            <div class="modal-actions">
              <button type="button" class="btn-secondary" onclick="manualModal.style.display='none'">
                Cancel
              </button>
              <button type="submit" class="btn-primary">
                Save Schedule
              </button>
            </div>

          </form>
        </div>
      </div>

    </main>

  </div>

  <!-- Other scripts -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.all.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script src="{{ url_for('static', filename='js/firebase-config.js') }}"></script>
  <script src="{{ url_for('static', filename='js/base.js') }}"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>

  <!-- EmailJS v4 UMD -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  <script>
    emailjs.init({
      publicKey: "qhnxSknhn12GlsccS",
    });
  </script>

  <!-- Your script (NOT module) -->
  <script src="{{ url_for('static', filename='js/schedules.js') }}"></script>

</body>
</html>
